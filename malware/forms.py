# -*- coding: utf-8 -*-
from django import forms

from models import Source
from models import Malware


class MalwareUploadForm(forms.Form):
    name = forms.CharField(label='Name', required=False)
    desc = forms.CharField(widget=forms.Textarea, label='Description',
                           required=False)
    malware = forms.FileField(label='Malware')


class MalwarePublishForm(forms.Form):
    channel_name = forms.CharField(label='Channel Name', required=False)
    malware_sha256 = forms.CharField(widget=forms.Textarea, label='Sha256',
                                     required=False)


class MalwareUpdateForm(forms.ModelForm):
    class Meta:
        model = Malware
        fields = ['name', 'source', 'link', 'type', 'size', 'crc32', 'md5',
                  'sha1', 'sha256', 'sha512', 'ssdeep', 'desc']
        labels = {
            'name': 'Name',
            'source': 'Source',
            'link': 'Link',
            'type': 'File Type',
            'size': 'File Size',
            'crc32': 'CRC32',
            'md5': 'MD5',
            'sha1': 'SHA1',
            'sha256': 'SHA256',
            'sha512': 'SHA512',
            'ssdeep': 'SSDEEP',
            'desc': 'Description'
        }


class SourceForm(forms.ModelForm):
    class Meta:
        model = Source
        fields = ['label', 'desc']
        labels = {
            'label': 'Label',
            'desc': 'Description'
        }
        widgets = {
            'label': forms.TextInput(),
            'desc': forms.Textarea()
        }
