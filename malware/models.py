#! -*- coding: utf-8 -*-
from django.core.urlresolvers import reverse_lazy
from django.db import models

from core.models import TimeStampedModel


class MalwareSource(TimeStampedModel):
    label = models.CharField(max_length=255)
    desc = models.TextField(null=True, blank=True)

    def __unicode__(self):
        return self.label

    def get_absolute_url(self):
        return reverse_lazy('malware_source_list')


class Malware(TimeStampedModel):
    DESC_DEFAULT = 'NO DESC.'
    source = models.ForeignKey(MalwareSource, null=True, blank=True)
    name = models.CharField(max_length=255, null=True, blank=True)
    type = models.CharField(max_length=255, null=True)
    size = models.IntegerField(null=True)
    md5 = models.CharField(max_length=32, null=True)
    sha1 = models.CharField(max_length=40, null=True)
    sha256 = models.CharField(max_length=64, null=True)
    sha512 = models.CharField(max_length=128, null=True)
    crc32 = models.CharField(max_length=8, null=True)
    ssdeep = models.CharField(max_length=255, null=True)
    desc = models.TextField(default=DESC_DEFAULT, null=True, blank=True)
    user = models.ForeignKey('auth.User', null=True, blank=True)

    def __unicode__(self):
        return self.sha512

    def get_absolute_url(self):
        return reverse_lazy('malware_list')
